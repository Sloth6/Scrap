mixin articleMixin(article, collections)
  -
    var classes =  [article.contentType] //, 'zoomTarget'
    var content = article.content
    for (var i = 0; i < collections.length; i++) {
      classes.push(collections[i].collectionKey)
    }
    if (article.contentType == 'youtube' || article.contentType == 'soundcloud') {
      classes.push('playable')
    }
    // var color = collection.color
    // var pattern = /^hsl\(([-.0-9]+),(0|100|\d{1,2})%,([-.0-9]+)%\)$/
    // var hue = color.match(pattern)[1]
    // var hslLight = 'hsl('+hue+',100%, 98%)'
        
    // if (article.contentType == 'text'){
    //   var backgroundColor = hslLight
    // } else {
    //   var backgroundColor = ''
    // }

  article(id=article.id, style= posString,
    class = classes,
    data-contenttype= article.contentType, 
    data-creatorid  = article.creatorId, 
    data-content    = article.content
  )
    .articleControls
      - if(article.Creator !== undefined)
        author.smallType!=article.Creator.name

    ul.articleCollections.parallaxLayer(style='position:absolute;',data-parallaxdepth='.125',data-parallaxoffset={x: 0, y: -24})
      - for (var i = 0; i < collections.length; i++)
        - var collection = collections[i]
        - var key = collection.collectionKey
        li.collection(data-collectionKey=key, class=key)
          a.typeSmall(href='#', style='background-color:'+collection.color+';')!=collection.name
    
    .card.cardHover.cardDrag(class=article.contentType)
      case article.contentType
        
        when 'image'
          img(src = content.original_url)
        
        when 'website'
          -var url = decodeURIComponent(content.url)
          .text
            header
              h1.headerType.parallaxLayer(data-parallaxdepth='.25')!=content.title
              .url.smallType.smallCaps!=content.domain
            .description.smallType.parallaxLayer(data-parallaxdepth='.125')!=content.description
          img.parallaxLayer(data-parallaxdepth='.0625', src=content.image)
          a(href=url, target='_blank', title='Open “' + content.title + '” in a new tab')
  
        when 'file'
          .fakeCard
            header
              - name = content.split('/').pop()
              //- - extension = name.pop()
              h1.headerType.title=name.split('.')[0]
              p.extension.smallCaps.bodyType=name.split('.').pop()
            ul.cardActions
              li
                a.download.confirm(href='#') Download
          .decorative.fold
  
        when 'video'
          video()
            source(src = content.url)
        
        when 'soundcloud'
          .preview.parallaxLayer(data-parallaxdepth='0', title='Play “' + content.title + '”')
            img.soundcloudThumbnail(src = content.thumbnail_url)
          header
            .top.parallaxLayer(data-parallaxdepth='0', data-parallaxoffset={x: 0, y: -48})
              .artist.smallType.parallaxLayer(data-parallaxdepth='.2')!=content.author_name
              h1.headerType.typeOutlineWhite.title.parallaxLayer(data-parallaxdepth='.25')!=content.title
            .detail.parallaxLayer(data-parallaxdepth='.2', data-parallaxoffset={x: 0, y: 24})
              .source.smallType.smallCaps SoundCloud
          .playButton.parallaxLayer(data-parallaxdepth='.3')
        
        when 'youtube'
          .preview.parallaxLayer(data-parallaxdepth='0', title='Play “' + content.title + '”')
            img.youtubeThumbnail(src=content.image, style='width:480px; height: 270px')
          header
            .top.parallaxLayer(data-parallaxdepth='.2', data-parallaxoffset={x: 0, y: -48})
              .artist.smallType Artist
              h1.headerType.typeOutlineWhite.title.parallaxLayer(data-parallaxdepth='.05')!=content.title
            .detail.parallaxLayer(data-parallaxdepth='.1', data-parallaxoffset={x: 0, y: 24})
              .source.smallType.smallCaps youtube
          .playButton.parallaxLayer(data-parallaxdepth='.5')
          
  
        when 'text'
          //- contentEditable="false", designmode="on"
          .editable.parallaxLayer(data-parallaxdepth='.25')
            | !{article.content.text}
          ul.cardActions
            li.right.showOnEditing
              a.done.confirm(href='#') Done
              //- a.invisible.cancel.confirm(href='#') Cancel
        default
          p!=article.content
    
      