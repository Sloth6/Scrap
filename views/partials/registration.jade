.login
  p
    input(type="checkbox", id="toggle-login")
    label(for="toggle-login") I have an account
  form(id="login")
    p.name
      input(id="name",type="text", name="user[name]", placeholder="Name")
    p.mail
      input(id="email",type="text", name="user[email]", placeholder="Mail")
    p.password
      input(id="password",type="password", name="user[password]", placeholder="Password")
    p.submit
      input.offset(type="submit", value="Login")
    p(id="errorField")
script.
  function onError(res) {
    $('#errorField').text(res.responseText);
  };

  $("#login").submit(function(e) {
    e.preventDefault();
    var fields = {
      email: $('#email').val(),
      password: $('#password').val()
    }
    var url = '';
    if($("#login").hasClass('register')) {
      url = '/register';
      fields.name = $('#name').val();
    } else {
      url = '/login';
    }
    $.post(url, fields).error(onError).success(function(path){
      location.pathname = path;
    })
  });

  $('#toggle-login').change(function() {
    $('#errorField').text("");
    if($(this).is(":checked")) {
      $("form").removeClass("register")
        .addClass("login")
      $("p.name").remove();
      $("input[type=submit]").val("Login");
    }
    else {
      var nameInput = "<p class='name'><input id='name' type='text' name='user[name]' placeholder='Name'></p>"
      $("form").removeClass("login")
        .addClass("register")
        .prepend(nameInput)
      $("input[type=submit]").val("Register");
    }
  })